{"ast":null,"code":"/**\n * Module dependencies.\n */\nvar eio = require('engine.io-client');\n\nvar Socket = require('./socket');\n\nvar Emitter = require('component-emitter');\n\nvar parser = require('socket.io-parser');\n\nvar on = require('./on');\n\nvar bind = require('component-bind');\n\nvar debug = require('debug')('socket.io-client:manager');\n\nvar indexOf = require('indexof');\n\nvar Backoff = require('backo2');\n/**\n * IE6+ hasOwnProperty\n */\n\n\nvar has = Object.prototype.hasOwnProperty;\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager(uri, opts) {\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n\n  if (uri && 'object' === typeof uri) {\n    opts = uri;\n    uri = undefined;\n  }\n\n  opts = opts || {};\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.randomizationFactor(opts.randomizationFactor || 0.5);\n  this.backoff = new Backoff({\n    min: this.reconnectionDelay(),\n    max: this.reconnectionDelayMax(),\n    jitter: this.randomizationFactor()\n  });\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connecting = [];\n  this.lastPing = null;\n  this.encoding = false;\n  this.packetBuffer = [];\n\n  var _parser = opts.parser || parser;\n\n  this.encoder = new _parser.Encoder();\n  this.decoder = new _parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\n\nManager.prototype.emitAll = function () {\n  this.emit.apply(this, arguments);\n\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n    }\n  }\n};\n/**\n * Update `socket.id` of all sockets\n *\n * @api private\n */\n\n\nManager.prototype.updateSocketIds = function () {\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].id = this.generateId(nsp);\n    }\n  }\n};\n/**\n * generate `socket.id` for the given `nsp`\n *\n * @param {String} nsp\n * @return {String}\n * @api private\n */\n\n\nManager.prototype.generateId = function (nsp) {\n  return (nsp === '/' ? '' : nsp + '#') + this.engine.id;\n};\n/**\n * Mix in `Emitter`.\n */\n\n\nEmitter(Manager.prototype);\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function (v) {\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\n\nManager.prototype.reconnectionAttempts = function (v) {\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\n\nManager.prototype.reconnectionDelay = function (v) {\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  this.backoff && this.backoff.setMin(v);\n  return this;\n};\n\nManager.prototype.randomizationFactor = function (v) {\n  if (!arguments.length) return this._randomizationFactor;\n  this._randomizationFactor = v;\n  this.backoff && this.backoff.setJitter(v);\n  return this;\n};\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\n\nManager.prototype.reconnectionDelayMax = function (v) {\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  this.backoff && this.backoff.setMax(v);\n  return this;\n};\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\n\nManager.prototype.timeout = function (v) {\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\n\nManager.prototype.maybeReconnectOnOpen = function () {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.reconnect();\n  }\n};\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\n\nManager.prototype.open = Manager.prototype.connect = function (fn, opts) {\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false; // emit `open`\n\n  var openSub = on(socket, 'open', function () {\n    self.onopen();\n    fn && fn();\n  }); // emit `connect_error`\n\n  var errorSub = on(socket, 'error', function (data) {\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    } else {\n      // Only do this if there is no fn to handle the error\n      self.maybeReconnectOnOpen();\n    }\n  }); // emit `connect_timeout`\n\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    if (timeout === 0) {\n      openSub.destroy(); // prevents a race condition with the 'open' event\n    } // set timer\n\n\n    var timer = setTimeout(function () {\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n    this.subs.push({\n      destroy: function destroy() {\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n  return this;\n};\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\n\nManager.prototype.onopen = function () {\n  debug('open'); // clear old subs\n\n  this.cleanup(); // mark as open\n\n  this.readyState = 'open';\n  this.emit('open'); // add new subs\n\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(socket, 'ping', bind(this, 'onping')));\n  this.subs.push(on(socket, 'pong', bind(this, 'onpong')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n};\n/**\n * Called upon a ping.\n *\n * @api private\n */\n\n\nManager.prototype.onping = function () {\n  this.lastPing = new Date();\n  this.emitAll('ping');\n};\n/**\n * Called upon a packet.\n *\n * @api private\n */\n\n\nManager.prototype.onpong = function () {\n  this.emitAll('pong', new Date() - this.lastPing);\n};\n/**\n * Called with data.\n *\n * @api private\n */\n\n\nManager.prototype.ondata = function (data) {\n  this.decoder.add(data);\n};\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\n\nManager.prototype.ondecoded = function (packet) {\n  this.emit('packet', packet);\n};\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\n\nManager.prototype.onerror = function (err) {\n  debug('error', err);\n  this.emitAll('error', err);\n};\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\n\nManager.prototype.socket = function (nsp, opts) {\n  var socket = this.nsps[nsp];\n\n  if (!socket) {\n    socket = new Socket(this, nsp, opts);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connecting', onConnecting);\n    socket.on('connect', function () {\n      socket.id = self.generateId(nsp);\n    });\n\n    if (this.autoConnect) {\n      // manually call here since connecting event is fired before listening\n      onConnecting();\n    }\n  }\n\n  function onConnecting() {\n    if (!~indexOf(self.connecting, socket)) {\n      self.connecting.push(socket);\n    }\n  }\n\n  return socket;\n};\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\n\nManager.prototype.destroy = function (socket) {\n  var index = indexOf(this.connecting, socket);\n  if (~index) this.connecting.splice(index, 1);\n  if (this.connecting.length) return;\n  this.close();\n};\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\n\nManager.prototype.packet = function (packet) {\n  debug('writing packet %j', packet);\n  var self = this;\n  if (packet.query && packet.type === 0) packet.nsp += '?' + packet.query;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function (encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i], packet.options);\n      }\n\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else {\n    // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\n\nManager.prototype.processPacketQueue = function () {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\n\nManager.prototype.cleanup = function () {\n  debug('cleanup');\n  var subsLength = this.subs.length;\n\n  for (var i = 0; i < subsLength; i++) {\n    var sub = this.subs.shift();\n    sub.destroy();\n  }\n\n  this.packetBuffer = [];\n  this.encoding = false;\n  this.lastPing = null;\n  this.decoder.destroy();\n};\n/**\n * Close the current socket.\n *\n * @api private\n */\n\n\nManager.prototype.close = Manager.prototype.disconnect = function () {\n  debug('disconnect');\n  this.skipReconnect = true;\n  this.reconnecting = false;\n\n  if ('opening' === this.readyState) {\n    // `onclose` will not fire because\n    // an open event never happened\n    this.cleanup();\n  }\n\n  this.backoff.reset();\n  this.readyState = 'closed';\n  if (this.engine) this.engine.close();\n};\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\n\nManager.prototype.onclose = function (reason) {\n  debug('onclose');\n  this.cleanup();\n  this.backoff.reset();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\n\nManager.prototype.reconnect = function () {\n  if (this.reconnecting || this.skipReconnect) return this;\n  var self = this;\n\n  if (this.backoff.attempts >= this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.backoff.reset();\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.backoff.duration();\n    debug('will wait %dms before reconnect attempt', delay);\n    this.reconnecting = true;\n    var timer = setTimeout(function () {\n      if (self.skipReconnect) return;\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.backoff.attempts);\n      self.emitAll('reconnecting', self.backoff.attempts); // check again for the case socket closed in above events\n\n      if (self.skipReconnect) return;\n      self.open(function (err) {\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n    this.subs.push({\n      destroy: function destroy() {\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\n\nManager.prototype.onreconnect = function () {\n  var attempt = this.backoff.attempts;\n  this.reconnecting = false;\n  this.backoff.reset();\n  this.updateSocketIds();\n  this.emitAll('reconnect', attempt);\n};","map":{"version":3,"names":["eio","require","Socket","Emitter","parser","on","bind","debug","indexOf","Backoff","has","Object","prototype","hasOwnProperty","module","exports","Manager","uri","opts","undefined","path","nsps","subs","reconnection","reconnectionAttempts","Infinity","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","min","max","jitter","timeout","readyState","connecting","lastPing","encoding","packetBuffer","_parser","encoder","Encoder","decoder","Decoder","autoConnect","open","emitAll","emit","apply","arguments","nsp","call","updateSocketIds","id","generateId","engine","v","length","_reconnection","_reconnectionAttempts","_reconnectionDelay","setMin","_randomizationFactor","setJitter","_reconnectionDelayMax","setMax","_timeout","maybeReconnectOnOpen","reconnecting","attempts","reconnect","connect","fn","socket","self","skipReconnect","openSub","onopen","errorSub","data","cleanup","err","Error","destroy","timer","setTimeout","close","push","clearTimeout","onping","Date","onpong","ondata","add","ondecoded","packet","onerror","onConnecting","index","splice","query","type","encode","encodedPackets","i","write","options","processPacketQueue","pack","shift","subsLength","sub","disconnect","reset","onclose","reason","delay","duration","onreconnect","attempt"],"sources":["/Users/imac/Downloads/Crash.BTC.Updated.V2.DEV/node_modules/socket.io-client/lib/manager.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar eio = require('engine.io-client');\nvar Socket = require('./socket');\nvar Emitter = require('component-emitter');\nvar parser = require('socket.io-parser');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:manager');\nvar indexOf = require('indexof');\nvar Backoff = require('backo2');\n\n/**\n * IE6+ hasOwnProperty\n */\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager (uri, opts) {\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n  if (uri && ('object' === typeof uri)) {\n    opts = uri;\n    uri = undefined;\n  }\n  opts = opts || {};\n\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.randomizationFactor(opts.randomizationFactor || 0.5);\n  this.backoff = new Backoff({\n    min: this.reconnectionDelay(),\n    max: this.reconnectionDelayMax(),\n    jitter: this.randomizationFactor()\n  });\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connecting = [];\n  this.lastPing = null;\n  this.encoding = false;\n  this.packetBuffer = [];\n  var _parser = opts.parser || parser;\n  this.encoder = new _parser.Encoder();\n  this.decoder = new _parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\nManager.prototype.emitAll = function () {\n  this.emit.apply(this, arguments);\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n    }\n  }\n};\n\n/**\n * Update `socket.id` of all sockets\n *\n * @api private\n */\n\nManager.prototype.updateSocketIds = function () {\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].id = this.generateId(nsp);\n    }\n  }\n};\n\n/**\n * generate `socket.id` for the given `nsp`\n *\n * @param {String} nsp\n * @return {String}\n * @api private\n */\n\nManager.prototype.generateId = function (nsp) {\n  return (nsp === '/' ? '' : (nsp + '#')) + this.engine.id;\n};\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Manager.prototype);\n\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function (v) {\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionAttempts = function (v) {\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelay = function (v) {\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  this.backoff && this.backoff.setMin(v);\n  return this;\n};\n\nManager.prototype.randomizationFactor = function (v) {\n  if (!arguments.length) return this._randomizationFactor;\n  this._randomizationFactor = v;\n  this.backoff && this.backoff.setJitter(v);\n  return this;\n};\n\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelayMax = function (v) {\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  this.backoff && this.backoff.setMax(v);\n  return this;\n};\n\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.timeout = function (v) {\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\nManager.prototype.maybeReconnectOnOpen = function () {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.reconnect();\n  }\n};\n\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\nManager.prototype.open =\nManager.prototype.connect = function (fn, opts) {\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false;\n\n  // emit `open`\n  var openSub = on(socket, 'open', function () {\n    self.onopen();\n    fn && fn();\n  });\n\n  // emit `connect_error`\n  var errorSub = on(socket, 'error', function (data) {\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    } else {\n      // Only do this if there is no fn to handle the error\n      self.maybeReconnectOnOpen();\n    }\n  });\n\n  // emit `connect_timeout`\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    if (timeout === 0) {\n      openSub.destroy(); // prevents a race condition with the 'open' event\n    }\n\n    // set timer\n    var timer = setTimeout(function () {\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n\n  return this;\n};\n\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\nManager.prototype.onopen = function () {\n  debug('open');\n\n  // clear old subs\n  this.cleanup();\n\n  // mark as open\n  this.readyState = 'open';\n  this.emit('open');\n\n  // add new subs\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(socket, 'ping', bind(this, 'onping')));\n  this.subs.push(on(socket, 'pong', bind(this, 'onpong')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n};\n\n/**\n * Called upon a ping.\n *\n * @api private\n */\n\nManager.prototype.onping = function () {\n  this.lastPing = new Date();\n  this.emitAll('ping');\n};\n\n/**\n * Called upon a packet.\n *\n * @api private\n */\n\nManager.prototype.onpong = function () {\n  this.emitAll('pong', new Date() - this.lastPing);\n};\n\n/**\n * Called with data.\n *\n * @api private\n */\n\nManager.prototype.ondata = function (data) {\n  this.decoder.add(data);\n};\n\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\nManager.prototype.ondecoded = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\nManager.prototype.onerror = function (err) {\n  debug('error', err);\n  this.emitAll('error', err);\n};\n\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\nManager.prototype.socket = function (nsp, opts) {\n  var socket = this.nsps[nsp];\n  if (!socket) {\n    socket = new Socket(this, nsp, opts);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connecting', onConnecting);\n    socket.on('connect', function () {\n      socket.id = self.generateId(nsp);\n    });\n\n    if (this.autoConnect) {\n      // manually call here since connecting event is fired before listening\n      onConnecting();\n    }\n  }\n\n  function onConnecting () {\n    if (!~indexOf(self.connecting, socket)) {\n      self.connecting.push(socket);\n    }\n  }\n\n  return socket;\n};\n\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\nManager.prototype.destroy = function (socket) {\n  var index = indexOf(this.connecting, socket);\n  if (~index) this.connecting.splice(index, 1);\n  if (this.connecting.length) return;\n\n  this.close();\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nManager.prototype.packet = function (packet) {\n  debug('writing packet %j', packet);\n  var self = this;\n  if (packet.query && packet.type === 0) packet.nsp += '?' + packet.query;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function (encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i], packet.options);\n      }\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else { // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\nManager.prototype.processPacketQueue = function () {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\nManager.prototype.cleanup = function () {\n  debug('cleanup');\n\n  var subsLength = this.subs.length;\n  for (var i = 0; i < subsLength; i++) {\n    var sub = this.subs.shift();\n    sub.destroy();\n  }\n\n  this.packetBuffer = [];\n  this.encoding = false;\n  this.lastPing = null;\n\n  this.decoder.destroy();\n};\n\n/**\n * Close the current socket.\n *\n * @api private\n */\n\nManager.prototype.close =\nManager.prototype.disconnect = function () {\n  debug('disconnect');\n  this.skipReconnect = true;\n  this.reconnecting = false;\n  if ('opening' === this.readyState) {\n    // `onclose` will not fire because\n    // an open event never happened\n    this.cleanup();\n  }\n  this.backoff.reset();\n  this.readyState = 'closed';\n  if (this.engine) this.engine.close();\n};\n\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\nManager.prototype.onclose = function (reason) {\n  debug('onclose');\n\n  this.cleanup();\n  this.backoff.reset();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\nManager.prototype.reconnect = function () {\n  if (this.reconnecting || this.skipReconnect) return this;\n\n  var self = this;\n\n  if (this.backoff.attempts >= this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.backoff.reset();\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.backoff.duration();\n    debug('will wait %dms before reconnect attempt', delay);\n\n    this.reconnecting = true;\n    var timer = setTimeout(function () {\n      if (self.skipReconnect) return;\n\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.backoff.attempts);\n      self.emitAll('reconnecting', self.backoff.attempts);\n\n      // check again for the case socket closed in above events\n      if (self.skipReconnect) return;\n\n      self.open(function (err) {\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\nManager.prototype.onreconnect = function () {\n  var attempt = this.backoff.attempts;\n  this.reconnecting = false;\n  this.backoff.reset();\n  this.updateSocketIds();\n  this.emitAll('reconnect', attempt);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}